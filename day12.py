import time
input = """??#??????#..????? 9,2,1
???##??#?.?#? 5,1,2
????.????. 1,1
.?#?????###???. 1,6,1
????.?#????#?? 2,1,1,3
??.??.?????#??##.??. 1,1,10,2
??.?###?#??????? 2,7,2,1
?????..#??? 4,1,1
#?????.?#???.#.???# 1,2,4,1,1,1
??#??#???????.?#??? 1,1,7,1,2,1
?..??#????#?.? 3,1,2
..#?????.#.??#.? 1,3,1,1,1
?#.?.?.??#??#?#??? 2,1,1,10
???#???.##?#?????#.? 1,1,1,6,1,1
?.??#?#?#?#?? 1,8
?#??????????? 2,4
??????????? 4,1,1
????.??#?. 4,3
??###??????? 6,1,1
?.?.?#???#?. 1,5
??.?#?..???.???###? 3,1,7
?????#.????? 3,2
#???????.??????#?? 1,4,1,2
?#??????????#??. 1,11
?.????..?..???##? 4,1,6
??????#???#?#?.# 9,1
?#?#??#?##?##?.#??. 10,3,3
??##?#?##????? 8,2
???#??#?.?.???? 5,2
?.??.?..??????.????# 1,2,1,6,3,1
?..#????#???#??.?.?# 1,1,9,1
.?#?.?????. 2,1
???##.???#???#???? 1,2,5,3,1
??????????#?.?.??.?? 9,1,1,2
.#.???????.???#. 1,1,5,1
??.??????##?.? 1,2,4
?????.??.#?.#.# 1,2,1,1,1
#?????.???????#.??? 1,2,1,1,2,2
?#?????..#????#? 6,1,4
.??????.???#??? 5,1,1
??????.?#??# 5,2,1
??.?#?.?#?.#??? 2,2,1
???#?.#???.?. 4,3,1
???.?#??##..##??.? 1,6,3
???##?#?#.#???.?#?. 1,7,3,3
#.?????#??????? 1,1,1,6,1
?#.?.???## 2,1,2
?.???#????? 1,2,1
?.?#??.?#?#??.#.?#?? 1,1,6,1,1,1
??.????.??#? 1,1,1,2
??.#?#??.???#??#?? 1,1,1,1,7,1
.?.??.#??? 1,1,2
????????##?#??#?..? 6,1
?.???#?#.?.?#. 1,5,1,1
?.??#???.??. 4,1
???.???.?#.?#??#?.?? 2,1,2,2,3,1
.#????#.??#? 6,4
#?????.???##?? 4,1,1,4
..????#??????????# 10,3
#????##?#..? 9,1
?#.?.?#?.? 2,1,1
?#?.##???????.????? 3,4,2,3,1
?..?#??##????????# 1,7,1,1
??.?#.??????????. 1,2,2,6
?????..?#?????????#? 1,1,8,1,2
??#???????. 1,4
?????????##.?????? 1,8,1,4
#?#.?.??###??#????? 1,1,1,9
??#????#.??????.??## 1,6,2,2,4
...#?.?###? 1,4
#.?#..???#??. 1,1,1,3
.????.???? 1,3
.#??..???????.?? 1,1,5,1
.???????????? 3,1,4
?..#????????.?.#?? 1,3,1,1,1,1
???##??.???.#? 2,2,3,1
??#?#?????????. 7,1,1,1
???###?#??.???? 9,2
??#?.??????.??##???? 3,1,2,4,1
????.???.? 2,1,1
?..?...#??????#?.?? 1,2
????#???#?????? 4,1,6
??####??????.#??#?? 8,2,1,1
#???????.??.??. 5,1,1,2
????#?#??? 1,5
.????????? 1,2
???????#?. 1,2
?###..##?. 3,2
.??#??.??????.??#.#? 2,1,4,1,1,1
?.??###?#.? 5,1
???##???#?#?.#?. 11,2
.??#???..?#?????#? 3,5,2
???#?#.???#?? 1,1,4
?.??.??.?? 1,1,1
???.???#???#?????#? 1,12
?#??????#?.?#? 3,1,3,2
?#??.?##???.?.?. 3,5,1
????.?????# 1,4,1
.???#???#??#.?.??? 2,5
##??????.?????? 5,1,1,1,1
.?##?###??#?? 7,2
#.????#?????????#??# 1,2,11,2
?.??.?#???????? 1,1,10
???#????#?? 2,1,1
????..??#? 1,2
.??..????##.? 2,5
?????.#??? 1,2,1
?..#.??????? 1,1,4
??#??#???###?# 5,3,1
???.?#..#? 1,1,1
??#?????#??#????##?? 1,2,1,3,1,6
??????????###??.?. 2,3,3,1,1
??#???.??? 3,1,1
????????.? 1,3,1
?#??.??????.? 2,6
???.#????..#??#? 2,1,3,5
????.?#??#? 2,2,2
??.????#????#????#. 1,1,5,1,1,1
??#.????##?#??# 1,8
?#???##?#???.#????. 8,2,1
#?#????#?#?.#?. 1,8,2
#??#??##?#???. 1,10
.?????.??? 5,2
?#???????.?. 2,1,1,1
?.##???..??#??###?? 5,1,8
?.??????#???.?#? 1,7,1
??.#??????.?.#???#? 1,4,1,1,3
.?#?????#????# 2,10
##??????#..? 2,2,3,1
#?????.??????#?? 6,2,2
?.#?????#?# 5,1,1
????.???#????????? 4,12
???##??.??????? 5,3,1
#?????#.?.??.#?# 1,1,1,1,3
??##??#?#? 4,1,1
???????????.?? 1,3,1,2
.?????#.??#. 2,2,1
#.#?.??##????#????? 1,1,1,7,1,1
?.??#.??????? 1,1,1,2
#?.?#??#?????.?.? 1,5,1,1
?.?.??#??? 1,4
???#??#?.?.????#.#. 7,1,2,2,1
..???#????????#? 5,1,1,2
##????..#???? 3,2,4
?.?.#?#?????.#??#?? 6,1,4
???.?##???.????.?? 2,4,1,1,1,1
??#????.?#?. 4,2
?#???????#?#???#? 3,1,7,2
????..#???? 2,5
?#.?????????? 2,1,3,1
?????.??##?#.#????? 1,1,6,1,2,1
#??#??..#? 1,1,1
?????#????#??#???.? 2,8,1,1,1
.????##?.#????#?. 4,6
.?.???.#?###.? 1,5
?.??##??????.#??# 8,4
?#????#??#. 2,5
??#??#.#???#???# 1,2,2,1,1
.#?..???.#??#?????#. 2,1,1,2,5,1
?.???##??#?##.? 1,7,2,1
?#??#?#.??.?.? 3,3,1
??#???#???#????. 11,1
.###?????????? 4,1,3
??#??#????..###?.?? 6,2,3,1
#???.##?.?? 4,2,1
??.##??#??.????# 6,4
????#?????. 1,7
???.???????#???#? 2,1,10
?????###??.?##?? 1,5,3
???#.##?#???#?#??? 2,1,8,1,1
?..?##?.?????#? 1,3,5
????????????###???? 1,1,2,1,8
#??.?#?#?.?????#?. 3,1,1,1,1,1
?.?????.?#??##??# 2,1,3,5
???##?#??????#.??? 10,1,1
??.?###?#? 1,6
???###??????? 6,4
??????#.?.#??? 1,2,2
.?.?.??#?????#???#?? 1,1,8,2
?#..??????#.????. 2,1,2,1,2
.??#?.????##??#.?.# 1,2,7,1,1
??###????.???#???? 5,2,2,2,1
?#???#?#..?? 2,1,1,2
?.#?#??.???? 3,3
.???#?.??????###???? 3,9
????.##?????..#??.? 1,1,3,1,1,3
????????.??????#? 1,3,6
????.#.?#?#?????#??. 2,1,11
#???????#? 1,1,1
?????##?##? 3,6
?#???.??##?#?????.# 1,2,7,1,1,1
.?.#??.??.???##???#? 3,1,9
#????????#???.??? 2,1,1,5,1
????#??.?.?#??###?# 2,1,1,1,9
?#.??..??###???? 1,1,1,5,1
?.??????.?#.?.?#???. 6,2,1,2
????#??????? 1,6,1
#?.??.??#?.??#??? 1,2,1,1,5
.?##?????#?##??.? 5,6
?????..####????.? 4,8
?#?????###???????. 9,5
?????????#???..? 1,3
??#?.???.?.?.?? 2,1,1
???.??????#??#??#. 1,2,1,1,2,1
.#???###??#???.?#??? 11,3
?.???.??##?. 2,3
???#???????##??#? 4,1,5
.???#?.?????## 1,1,2,3
?..????##????.??#.?. 7,2
?#?#.??#???.????#.? 4,6,1,1
.#??????##??##.?###? 2,2,4,2,3
?????#???##???.##?. 1,4,3,1,3
#..???##???##?.??#. 1,5,4,1
.????#?#..????#??. 6,2
??#??.???#?####. 2,1,8
.???.??#?? 1,4
?#?..????#??????? 2,9,1
????#??#??#???.?. 6,4,1,1
???????#.?..?? 5,1,1
??##?????##.??.????? 11,1,1
.#?##?????. 5,1
#.??????#??????? 1,10,1
??#??????.##???. 1,1,1,1,4
?????#??#?. 1,1,2
?.?#?#??.?.#???? 4,3
#?#.?#.????? 1,1,1,1
??????????#? 5,1
??????#?.?##?#?????? 3,7
.????????.?...? 1,2,1,1,1
??##???##??#.???? 1,2,4,1,3
???#?.#????? 1,1,1,2
.??????.????.??#? 4,3,4
??????.??????? 1,1,2,2
????..#??#??? 1,2,1,1
??#??????#?????.???. 10,2
?..#???..??..?.? 4,1
??#?#??#??.#.??#? 7,1,1
..?#???.?.?????? 5,3
?.????#???.?#?? 1,2,4,2
.?#????#??.?? 5,3,1
.#.????##??????????# 1,17
???????.???.# 2,2,2,1
??##?????.??. 7,1
?.?.????.??? 1,1,1,1
?.????????.# 1,4,1
?????#??..#?#.? 1,1,3,3
?#?.#?##??#?? 1,5,2
?.??##??#??#???? 5,4
?.?##?..???###??? 3,6
??#.??#.??.. 2,1,1
#?##?????????#???? 1,2,1,6,2
?.?????.?????#??.#.? 1,1,1,8,1,1
??.?#?.#?##????#.? 3,5,3
..??.????????..? 1,2
.???..????.???..? 3,2,2,1
?.?.??.???. 1,1,1
????#?#??????.??.??. 8,1
??#????????? 4,1,3
??#??????..#?#?? 2,1,2,3,1
?#??#.???# 1,1,1
??#?????#?? 2,4
????#.?#???? 5,1,2
??.???#?????.??#??#? 1,3,1,6
?#.?#.????.#? 1,2,2,1
#?#??#????.?.??????? 8,1,1,2
??##???#.??. 4,2,1
?##??#???.? 6,1,1
?.#?#.?#??????? 3,5
?????#???#..?. 1,8,1
??#..#????.. 2,1,1
?#????.?#?. 2,2,3
?.#????#????###?? 8,3
????...?.?? 2,1
##.????#?????.?##?? 2,5,4
.?#????.???? 6,1
??.?????..???..??? 2,3,3,2
???????#???#???????? 1,1,8,1,1,1
.?.???.?#??.?.?? 1,1,3,1,1
????#.????###.?? 1,1,1,7,1
?.?##?#???.#???.? 5,4
????#?...??.##?????? 2,2,1,5,1
??.???###? 2,6
??.??.?.?##???. 1,2,6
???????#???#?.??#??? 10,5
?.???????#?#??. 1,8,3
..?#?##?.???? 4,2
.?##?#?????. 5,1
?#????#?.??. 1,2,1
??#?#.???????. 3,3
???.????#??.# 2,7,1
????#?.#????????? 5,1,1,1,1
????##???????? 5,1,1,1
???#?????..?#? 2,5,3
?..??##.?????#.?? 4,1,1
.?#????.???#####?? 4,2,7
???.?###.???.? 4,2
?#?????.?#???? 6,4
???#?.?..????? 5,1,1,2
??.#??????####??? 1,1,2,1,7
?.???????#? 2,3
..#????????#? 8,1
?#?##?##?##????. 12,1
?#?.??.?.?# 2,1,1
.?.?#???#?.????. 1,6,1
?#???.??.???????? 5,1,1,2
???????#?#??.?..?? 1,6,1,1,1
???????#???.. 3,1,1
..??#?????????? 1,2,6
??????##?????#???## 8,1,2
??????.#?####?#?#??# 1,1,1,6,2,1
#?#????..#?.? 1,5,1,1
?##???..?#? 2,1,1
.????#.????.??#?#. 1,2,2,3,1
?###??????#. 5,1,1
.?##??#?????...???? 9,4
?.???#?##?#??? 1,10
???.?.?#???#???? 2,1,3,2,2
?????##?##?#? 2,2,2,2
????#???## 2,2
??##..#.??.? 4,1,1,1
??..#?#????? 4,1
.??#??????#?????#?? 3,3,3,4
#?#??#?#??#??. 6,1,4
???##????.?#. 5,1,2
??????##?????# 7,1,2
#??##?#?#????#?????? 12,1,1,1
?.?.???.???. 1,1,3,2
???#.??#####??##?? 1,1,12
??#?##.?#.?? 4,2
?????????.???.??#?. 1,6,1,4
?.#??.?#.???.?. 1,1,2,1,1
?.#????#??.??? 6,2
#?..?#?#???###??#?? 2,14
????????##?????.?#. 3,5,1,2
.#??#?..?????#????? 2,2,8,2
#?????#?????.?.?# 1,1,4,1,2
???#???????? 1,2,6
???????.?..? 1,1,1,1
..?#.?#???.#????#?. 1,3,1,1,1,2
.??#?????##????##.?? 11,3
.##?.##???##?#?#??? 3,11
?##???#.????#??.#? 7,1,1,3,1
???.??#??#?????????? 1,1,1,10,1
?#.#??????#????#???# 2,4,3,7
.#????#?##??#????#? 2,8,3
????????#???.???#??? 1,5,1,2,1,1
.#??????#? 2,4
#?#?????????# 3,5,1
..??#??.#?? 1,1,2
??.?#????.??? 3,3
???#?#?##?#?????? 11,1
#?????#?##???#?.?.?? 4,8,1
?#??.?#??. 2,4
???????..?#?.??? 3,2
?.##?#?.????##?. 5,4
???.#???????????##? 1,7,2,3
.??#?.??#??? 1,1,4
??.??.?#??? 1,4
..?????#.?.. 1,1
??????.???#?#?##??# 1,1,1,1,6,2
??##?#..#??##?#???.? 5,7,1
???#?#????#?.#. 1,5,1,1
.????????? 1,1,1
?#??????????????? 6,1,1,1,1
?.?##???..#. 1,2,1,1
#?#????.#.?????##??. 3,1,1,7
?????.?#?#??#??????? 1,1,1,6,5
??..?.??.#????# 2,1,2,4,1
?##??#??????????.? 9,2,1,1
#?.#..?#?### 1,1,6
???#???.???#??#.?? 1,1,1,3,1,1
?#?????.?#????#???? 3,9
.??????.??.? 4,2
?#?#?.?#??#?#???? 4,2,2,1,1
???.#??#?##??? 1,1,6
??.?..??.?..#????. 1,1,2,1,2,1
???#?????. 2,1,2
.???#??#??? 3,4
#????#?#???? 1,2,3,2
??#??.#?... 2,2
??.?.??#??#?. 2,1,5
???#??????????? 8,1
#????#?????# 2,7
??????.#.##?? 4,1,2,1
?.?.?#?###??#? 1,1,6,2
??.?.?#???#???? 1,1,8,1
?###?..??????.#?.??# 4,5,1,1,1
??##?#???????##??# 6,8
???.?????.????. 1,3,1
????#?????????#??? 9,3
??#???#??????#???? 10,3
.??.##?#??#???#??.. 9,2
..#?#?###???.? 7,1
?????#??#???#??.?.? 2,6,2,1,1
??????.???#????.? 1,8
.?????.#.##? 2,1,2
?.??#?#??????? 1,4,1,1
??#???#.?.?#??#? 2,2,2,3
.?#?..????# 2,1,2
.??##??#?#??? 4,2,1,1
?#???#?#?#..? 2,3,1
.?????###????. 1,5,1
??.???#???#?# 1,8
?#?.#?#?#??.?#?. 2,6,2
?.????#??#???.?? 1,7,1
?.??...???? 1,2,1
.#?.?#.?.???? 1,1,1
.#?##??????? 5,3
..#?#??.#????#?? 3,7
?.?#??##?#?????##?? 1,1,7,2
??????#..?#????? 6,2,2
??#.??.?..?.???? 2,1,1,1,2
???..???????? 3,7
???????.#.??????. 1,1,1,1,6
?#?.??.?#?#?#??????. 2,1,6,1,1
.?#??????. 1,1,1
.?##??#.????? 6,1
?.?#?.?#.?? 3,1,1
?????.????? 1,1,2
??.???????#?? 1,5
???????#?.???.????? 3,2,1,2,5
??????????##?????? 2,2,6,1,1
??#????.?????#?##?# 2,1,9,1
??????#?#.?.?. 8,1
?..#?.??##.?.?? 1,2,2,1,1
??..#??##.?#????#? 1,1,2,1,4
????#?#..?.#?????? 7,1,1,5
.#??????????.???.? 6,1,1,2,1
#?..???.?? 1,3,1
..?????.??.??# 2,2,2,3
.??????.???#??.?? 1,3
..?#.?.????.#?????? 1,1,2,7
??#?#?.???????.? 3,1,1,3
????#??????????## 11,1,2
##??????.???????. 5,1,1
#????#????#?##? 1,10
???##???##?#?????#?? 15,1
????.??????#?#?? 2,7
???#??..?#??##?? 3,8
.##?.#.???? 2,1,2
.?#?????????#?##?#?? 2,1,8,1,1
???###..?#?..??###?? 5,3,1,5
?#?.??#?#?. 1,3,1
??????#?????#??.?.# 1,6,5,1,1
??????#???.# 3,4,1
??#?.??.?##.?#? 3,2,2
????????..??.?.. 1,1
#???#??.????# 7,1,2
??????.?#??. 1,1,1,2
?.#???#???????.? 1,6,1
#.#.##????.#? 1,1,6,1
?.?#?????.?#?#? 4,5
??.?#????? 1,1,1
.?##?????#.????.??? 7,1,1
####.#???#.?.???#?#? 4,1,2,6
???.##??#???##????? 1,1,14
??????#??#??#?#???? 7,1,2,2
.#.????##???????? 1,9,3
#??#?.???##?? 2,2,2
#??#?.??.? 5,2
?#?##?#####????#.?# 12,1,1,1
.?#?#??#??#?????.. 10,2
?????.???#????? 3,7
?.????#.??.??.???##? 1,2,1,1,1,4
?????#??..?????##? 6,7
?#??#?.???????##? 1,1,1,1,3
?##?????.#.?#? 8,1,1
.?#????.??? 4,2
#????#???#????.?#?? 1,1,8,3
?.??????#????#???# 1,1,1,7,2
???????#?#?#?? 2,7
??#?????.#? 3,2,1
?#?.??.?..#????.??## 1,1,1,5,1,2
?????..????????. 2,1,4
.???#?#??#??#?.???? 13,1,1
.#?..???????? 1,1,1,2
??????#??????? 3,9
??#?.??.?.????#???? 4,1,2,2
??##??.????#? 3,1,1
.???##?.?????###. 4,6
?#.??#???#? 1,5,1
????.???.????#. 2,1,5
??.?.?#?????#?. 2,3,2
?.???##??##.????? 9,1
..?.??????????#?.??? 1,1,9,1,1
#?.##??##??#???.? 1,7,1,1,1
#???.#?.????????.# 3,2,3,1,1
?#???#?.#?????## 1,2,2,1,2
.#?##?##??#?# 1,10
?#?##.????.#?????? 1,2,2,1,2,4
#..??###????.#? 1,5,2
.???#??????##???#?? 8,4,1
?.????#???????????. 1,9,2
?#??#????##?.??????? 11,1,2
??#?#.???? 5,1
#?????.???# 4,1,2
???#??#???????????? 2,2,1,7,2
????.???#?????? 1,1,1,1,3
?????????.???#????? 9,1,3,1
??????.??.??.???.??. 4,1,1,2,2,1
???.?#???????#??? 2,4,2,2
###???#???#??.??##?. 7,5,5
.?????####???????? 6,1
????.????? 1,1,1
?????###??#???? 2,5,5
.??.???#??.?.???. 2,5,1,3
#.??#????.???### 1,3,3,1,3
????????#.? 1,3
????##??#.?????. 1,3,1,1,1
..#????#..?#?????? 3,1,5
??#??#?#???#?.? 2,2,2,3,1
###??#?????.?. 4,5
????.?#???.?? 3,2,1
#??????..??#??????? 4,2,2,1,2
???#?#?..#??.??? 4,3
???#????..?? 8,1
#?.?#?????? 2,2,3
??#.????.????## 1,1,1,1,4
???#.?.#?..? 1,1,1,1
#??#????#??##?#? 6,2,5
.????.#???. 1,2
?????.?????.??##??.? 3,1,1,2,4,1
.?#??#??.?. 2,4
????????#???..? 2,6
?#???##???#?.?..??# 8,2,2
.??#?..#????.?? 1,5
.??????#???.?#?#. 1,4,3
????.?????#? 1,1,1,2
.#.?.?.??? 1,1,1
#??????.#? 3,2
?????.#?##?.???#. 2,1,5,2,1
???#?.?.???##??.?. 1,4
?##???????? 4,5
?#?#??#???#??.#?#?? 3,8,4
##?????#??????? 2,5,1,1
????.?#??..????##?? 1,1,1,1,6
????.#???.????#??#? 1,3,1,3,2
?..???#??###???? 1,1,8
??#?#??#???? 3,4,2
#????.??.#?? 5,1,1,1
?.????##???#?????.? 1,11
??????..?.?#?.??. 1,2,1,3,1
?????.?#?? 1,1,1
.?.????????# 1,2,5
.?.?.#?#.????. 1,1,1,3
.???.??#?????#?? 3,10
???#?#????.?? 5,2,1
??#.???.?? 2,1,1
??###??????.?#?? 11,3
??.?????????#?. 2,2
.??#?#??##???????.# 12,1,1
.##??????????.. 3,1,1,2
?????##.?#??.#?.??# 1,1,2,1,1,3
.??..???#??#??.# 2,1,1,2,1
??#.?#.#?.?##?#?#??# 2,1,1,6,1
?.??.??#??? 1,1
#?##??.?##?#?#?#?? 5,10
.??#?.#??#. 1,2,1
?#??????#?.?? 1,5,1
##???..???#?..?????? 2,2,4,3
??.#????.#?? 1,1,2,1
?.?#.???.???? 1,1,2,1
.???##?..?..?#?.??? 3,1
?????????.##????.??. 7,4
##???#?.??.???. 3,1,2,1
????????#..#?.?##?.? 9,2,3
?.??.?..?#. 1,1,1
???????.?##. 5,1,3
#?#.#.???????????##? 3,1,6,6
?.??#??????? 4,3
??#?##???.##? 8,2
???.???.#????.#?.? 2,3,3,1,2
???????##???? 2,2,4,1
????##?#???? 1,7,1
##??..???? 2,1,1
?#??..??.? 3,1
?.??#??#..????.??? 3,2,1,1,3
#?#..#?????#??.? 3,1,5
?????.???????#??. 1,3,2
?.?#????.?? 4,1
?#???#????????#? 11,1
#????#.#??#????#?#?. 1,3,6,3
?????##?.##??.? 2,3
??.??#??..??? 4,2
?#?#???#??#??##????? 1,8,4,1
?????.?.?. 2,1,1
?.?#..???##??.?. 1,1,5,1
??##???#???#?#.?.?. 1,8,1,1,1,1
?#???#??????.???#??. 10,2,2
#?.???#??#?.?????? 1,7,4
???????##?#??? 1,1,8
??.?????##?? 1,1,5
??#??##??##?????##?? 2,2,9,1
?.?#??#?##?.???????? 8,7
???#?#?#?#??????.?? 2,1,11
.????????..?? 1,1,2,1
?#??#?.??.?#? 4,1,1
???.?????#.?#??.. 6,3
#..?#???????. 1,8
?.???##?##?##??#?..? 14,1
?.???..??.??##?? 2,2,2
????#.#?.? 1,1,2
??????#??????#??? 1,4,1,4
?????.?.??. 4,2
?##??..#?.? 3,2
#?.??#.?##??#??#? 1,1,1,8
??#??##?##?#?#?..? 2,10,1
??????##??????.???? 1,10,1,1
?????...?# 3,1
?#?.?#?#?.?# 3,1,1,2
.#?.?#.?#? 1,1,2
??#????????#???.???? 13,1
.????????###????#. 2,1,8
???.?##??.??????# 1,5,1,2
????????.?? 1,5,1
??.?#?##???#?#.. 5,3
.#????????#?#? 3,4,4
???????.??#??? 4,4
##..????##?.?.?. 2,2,4,1
?.???????#?#.????#? 10,4
.?????#??.????#??. 5,1
?#.##??#?????. 1,7
?????????.????? 6,1,2
.?..????#? 1,4
?.##???????#?? 1,3,5
??#?????#??#?#?????. 2,11
.?.???????## 1,6
#???..?.?.?? 3,1,1,1
##?????..??? 2,1,2
#?.??.???????#.???? 1,1,1,2,2,4
?#?#?????.?.?? 4,1,1,1
?????#?#?.???.?.? 8,1,1,1
??###?#??????.?.#?. 10,1
?#????.?????.?? 1,1,4,1
?#?#???##?#??#??#.# 1,1,7,4,1
#.?????#????? 1,1,6
?..#??.???. 1,2
????#?#??.???. 1,5,1
.???.?????#?##?..? 1,8
#??#?#???????.#???#? 6,4,1,1,1,1
.?.##?.?..??????? 3,5
??.#???.#?#?.???#??? 1,4,3,1,1,2
.##?.??.?## 2,1,2
?##.??#.?#???#? 3,2,1,3
.??????#?????? 8,2
#..?????#????#.?#?#. 1,6,1,1,2,1
.????.??.?#?? 2,2,3
?#?#???????####.?#? 3,1,4,3
?#.????#.?.??? 1,1,2,2
???????.?#??#????? 1,1,9
.#?##.????? 1,2,3
???#??#?.??.?. 8,1
..??#??.???#???.? 4,4
???#??##???##??????? 13,1
?????#.?????#???#? 1,1,1,1,4,1
????##????.??.?##. 6,3
#???.#?.?#? 1,1,2
##???????#?#.???? 10,1,1,1
??#??##??#??.??.?.? 10,1
?#??#?#????#????? 1,9,1
#???????.##?.?#???? 2,1,3,2,2
?###??#?#?.#..??? 10,1,1,1
??##??.?????.??. 3,1,1,1,1
??#.?#???.?? 1,5
?##?#????##??#? 10,1
???#??????##?#???? 2,10
???#?.??#??? 1,1,4
???#?#????##?#?.?? 13,1
?#??????????.??. 2,4,2
?#.?##?#?? 1,4
????????..? 1,1
.??##?#???? 5,2
?##???#????###? 3,5,4
??..?.???????##?? 1,1,8
??#?##?????##??. 8,3
.##?..#?????##...? 3,8
????????#??.???# 10,1,1
.??????#?????. 1,1,5
?????#???#. 1,3,1
#.?#.??#.???##.. 1,1,2,4
??#.?.??#? 3,1,1
?.?.##??#??#.?.# 1,8,1,1
??????##?#?#? 1,5,1,1
??????#?????..????? 3,3,2,5
?##?????#.? 5,1,1
??????.??#.##???? 2,3,3,1
####???????#??#?# 6,1,5,1
.??#??#.?#.????##??# 1,1,1,2,1,6
#?#?#?#????????.?? 9,4,1
???###?##??.???. 1,8,1
???##???#??#.??? 2,6,2,1
???.??#????? 1,6
..?????#?. 1,1,1
#?#??.#????#? 5,6
.????#?????#?? 5,1,1
??.??.??#.??????.# 1,1,3,1,1,1
???????..#?#??#. 5,6
??.???###??##?????# 1,1,12,1
???.??????#?##?. 2,10
#????????.?..#.#.? 2,5,1,1,1,1
.?#???##.???#????##. 7,1,1,2
???????#???.##???# 2,1,1,6
?#???#???.?.?? 2,4,1,1
?.?.?.???.???.???? 1,1,2,1,2,1
?#??????.?#????#???. 4,1,1,1,1,1
??#?.##???? 1,1,5
?????#???# 3,1,1
.????.????#.. 3,1,2
???????#?.??##.???.? 5,2,1
?????????#?. 8,2
????#?#?.?.??##????? 1,5,1,1,4,1
?#.?#????####??#.? 2,12,1
?.?##..????#? 3,5
???#???#??? 1,6
??###???#????#.????? 1,7,1,1,2,1
??.????.?? 1,1,1
????.?##?#?## 2,7
.??????#???. 2,5
???##????#?#..## 1,2,4,2
.????.?##?? 1,1,4
#.??#?#.????.?.. 1,5,3,1
#.??.?#?.?#??. 1,1,1,3
???#??????#.?#?? 6,1,1,2
??.?.?#?.?? 1,3
?#???????#.? 4,1,1
?..????##????????.? 1,5,1,1,3,1
#..?#.?#??#??#??##?? 1,2,2,9
#??#?##??..??. 1,5,1,2
?#?????#????#??#..?? 2,12,1
??#.???#??????? 3,2,3,1,1
.?????.#????#???? 3,9
???.????#??????.?# 1,2,1,4,1
??.???.?#?# 1,3,4
#????????#??#..?#.? 4,8,2
????#?#?#??????????? 9,6
#???????#???#???.?.? 1,1,1,9,1,1
?????#?#?#??????. 1,9,2
?#????..?#????# 1,1,1,7
#?????????### 5,1,3
.#?????????? 1,3,1,1
?.?##???????#??#..?# 7,1,4,1
?#???????##??##?? 3,11
.????.#??.?#?#?#?.#? 2,1,1,1,7,1
???????#?.. 2,2
??#?#.?###??##??#?? 1,1,1,8,1,1
??##.?????????#?? 1,2,10
.?????.?#?. 1,1,2
#?????#??#???#..# 1,1,6,3,1
?#????#???.?.#?. 1,1,4,1,2
??#???##??.????#? 8,5
.????.?????#??. 4,1,4
????.??###?. 3,6
????.#???.? 1,4,1
??#???#????###?.. 3,8
.?#???????###??.## 13,2
????.#.????#??? 1,1,1,1,2
#??#?????.? 4,1,1
#?#.???????.? 3,3,1,1
.????????.??. 3,2,1
??.?.??.??##?????? 1,1,1,9
?..?#??#?#??#.?? 1,7,1
??.???##??#?.?? 2,5
.????#.??????? 3,1,2,3
??..??????#? 1,1,2,2
??#??.????# 1,3
??.???????? 1,6
??.?.?????????.???. 1,6,3
#???###???.#??? 1,6,2
?.#???#??????# 2,4,1
??##.???#??.????##. 2,5,6
##.?.????????# 2,1,3,1
#?##.??.#???? 4,4
????#????..?#?? 5,3
.??##?#???.?.???? 9,1,1
???#?#?#?.?.?.. 8,1,1
#????##???#???#???.# 4,2,7,1
.?.???#.?##?????# 1,1,2,3
#?????????#???..#. 5,8,1
???#??????#?..??? 5,3,2
???#?????? 4,1,1
?.???#????####????#? 1,3,6,1
????#?.#???.??#??? 1,1,2,1,5
##????#?..???? 7,2
?#??.?.??#?..???#? 4,1,1,2,5
.##????????..?? 6,1,1,1
????????.#????. 1,1,1,1,2
??????????#??.?????? 3,4,2,1,1,1
?#?.??????.? 1,2,2
.?.?#????#???? 2,1
?.?#????.?? 1,6,1
.?##???.?????. 2,2,4
#.????##?? 1,7
??#???##?#?? 2,6
.?.?#????. 3,2
?#??#?#.?.?##???? 6,1,4,1
?????.?.???#??????? 1,1,1,5,3
.#???????.#? 5,1
????..??#???#?. 3,8
?#??#???.?#?##.?? 7,4
?#????#..#????????? 2,1,1,4,1,1
...?#??#?.#?? 3,2,2
###???#?.???? 4,2,3
???#??????..?##? 4,4,4
????.????#? 2,1
????##?#???.???? 7,1,1
?????????.?..??. 3,2,1,2
#?..#????? 1,1,2
##???#????#?.???.. 7,2,1,1
??#????????#?..?##?? 11,3
.?#?..#??##???.. 3,8
##?#????#.?#?.#???## 2,2,3,2,2,2
???#???????????.? 1,3,5,1,1
#.????????#? 1,1,1,3
??.?.??.?.?.??????? 1,2
???.#???????#??## 1,3,8
..?#??.??##?????. 2,5
????.?????????? 1,1,2,2
#????.??#? 5,2
?.#??#????#?????.?# 5,5,1
?.?#??#??? 4,1
????????.????.? 8,2
????.?#?????. 1,1,3,2
???#??.?#??# 5,5
????#.?#?.##??????. 1,1,3,5,2
.?#??.?#?#?????. 4,4,2
??..?#?#????.#? 6,1
.?.#.?#????#???#?##? 1,1,15
#.?????##.? 1,5,1
.##?????.????????? 5,2,4
???.???.##???#.?#?? 1,1,1,6,4
???#??#?????# 1,2,4,1
#???.##??##????? 4,9
???...#?...???# 1,2,3
##?#?#????.# 6,1,1
.??#??..????.?# 2,1,1,1,1
##??#???????#.??# 5,1,1,1,2
.#???#?????##.??#?. 1,3,1,1,2,3
??????#???? 2,3
?.???#??#? 1,2,2
?#??.##?????#? 2,2,1,2
??#.??#?.??.#?#??? 3,3,1,1,1,1
?.?##?.?.???#?#.? 1,3,1,4
??.???#?###?#.? 1,1,6,1,1
.?.#?????#?.?????? 1,3,3,2,1
?#?#?####..#.? 8,1
???##?#????.??#??#?? 9,1,3,3
??#????#?.??#?. 1,7,4
???#..?.?? 1,1,1
?????#????.??###? 6,1,6
.#?????#?????.??# 1,5,1,1,2
???#????..???#### 3,7
???????##..? 1,4
.??.??.???... 1,2,3
.??.#?#?????#? 1,9
???#???.?????? 1,4,2,1
??.?#.?.??.?#???#?? 2,1,1,8
##.##?????????#.?? 2,2,7
???###??##?..??.??? 5,3,1,2
#..????#?#???? 1,1,4,2
???????????#? 2,2
??.?##?#????????#??# 1,8,2,1
????#?#???????????? 7,1,1,2,1
.#??.?#??.# 1,2,1
?#???????? 2,1,2
?????#??#???.??? 1,4,1,2
?.?????.?.????##? 3,7
???..#???#???#??. 1,2,7
???.#??#?#???#.?? 1,1,8,2
###?##?.???#??# 7,5
.???.?.??#? 1,1,2
??#??.???# 2,4
??###?????. 6,1
???#?#????.?.?#.?.# 4,5,2,1,1
.??????.?#...?#??. 2,1,3
.??#.??#?? 1,2
??#??.?#??#? 1,1,1,4
.?#?#?..#?.??? 5,1,2
#??#?##?#?..?#??? 1,7,1
#???????## 2,3,2
???.????##??#?#?.#?? 1,11,1
#.?..????#?#??..?#? 1,1,9,1
.?.?????#??? 1,4,1,1
.???.???..#?##??? 3,1,5
??..????.???.?# 1,4,1,2
???????#?? 1,1,3
.????????#??#.??. 1,9,1
?.?.#????.#????????. 3,7
????#??#??????.??.#? 8,3,2,1
?????.#???..???#??? 2,1,4,4,1
??#????..?.? 5,1
???#?#?#????.?##???? 11,7
?????????????#??? 4,10
?.??#...?#???.?.. 1,3
.????...???#...? 1,2
??#?.#.?????##? 3,1,1,1,2
????#.??#?.#. 1,1,3,1
#.??????#??##??#???? 1,17
###????.#?? 5,2
??????????#.?.?...?. 10,1,1
#.#.#.???##??#??.# 1,1,1,9,1
.??.??.#?. 1,1,1
?#???.???##??#?#? 1,1,1,8
.??##?#??????#???## 9,3,3
.???????#? 5,3
.????###??#?.???? 9,2
#?##??????????? 7,3,1
???..#?#???#???.? 1,9
??#.???#.# 2,1,1
#.?#??.#?.?? 1,3,1,2
.#??????#???????. 2,4,1,2
..??????.??? 1,2
?##???.??.??#???. 2,2,1,3,1
.?.?##???#.?? 3,2,1
..???????? 3,1
??.??#????????#?#? 1,1,1,1,5
#?.?#.###??##??????? 2,1,9,1
.#?????.??. 2,1,1
.??.??#????## 2,4,2
?#?#?#?#?###?..?? 12,1
??#??.??#???? 3,2
#??#??????.?????? 1,1,4,1,1
#??#???#??.????#??? 4,2,5,1
???????.?#?? 5,1
?.#??#??#????#???.? 8,6,1
.?##?#?.?.?? 5,1
??###??????##??. 5,4
?#?#.???.??# 1,1,2,2
.???????.?#?... 3,3
??.?#?????.?.??##?#? 1,1,3,1,7
?#.???????.???#? 2,1,1,1,2
.??#?????. 4,1
????.?#???.??????.. 2,3,1,5
.??????.#? 1,2
.??.???#?.? 2,3,1
#?##?.?.???.## 5,1,1,2
.##????.?? 4,1
#??.?#???.?##?... 1,1,4,3
?...##??.? 1,2,1
?###..#??? 3,1,1
?#?##?#??##??? 1,8,1
.??###??.?#?.???###? 4,3,5
?.??????#?##???? 1,1,9,1
?????#??.?????? 7,2
.???#????#???#? 6,2,3
????.????.?#?..??? 3,4,3,2
????.#?.???#?? 1,1,2,6
?.#???#?#?.?#?? 1,5,2,1,1
?#?.#.???????.?? 1,1,1,3,1
?#?????????????? 3,1,2,1,3
???.#??#?#???# 7,1
??#????#???.##??#. 8,1,5
???#?????#??.? 2,5
.#????.???? 5,1
??????#?????###?? 5,3
?..??#???.????? 1,1,1,2,1
#??.?...?.??. 2,1,2
?#???#?????.#??? 2,1,1,2,1
?#?????????.??????? 2,3,1,3,2
.?#???????? 2,2,1
?#??.?.?.?.? 3,1
?##?..????#?? 4,1,4
???#?..???????# 1,2,7
??#??##?.??????.?? 2,2,1,1,1,1
.#?#...#?????? 3,1
.??..??##? 1,4
?????##??.??##?.. 6,5
#?..?#???.?? 1,3,1
?##??.?.#?#????? 3,1,3,1,2
.?#?????..#?#..?? 7,3,1
????????##?##.?#.#?? 1,1,1,7,1,2
???..????.?.???##?? 2,2,1,1,2,1
??????.??????.# 3,1,2,1
#.??#????.??#?? 1,3,1,1,1
??#####??#?????#?# 10,3
##???###?#????? 12,1
????????????? 2,5
??#??.????.?##? 2,4,2
?.?#???.#?#.???#.. 1,4,3,2
????#????#? 2,2,2
???.#?.?#????? 1,1,2,6
?.#???#?????#?????. 5,5
??????#??#??? 1,7
??.??????#???#?????# 1,1,7,3,1
#?..?????? 1,3
??#???..???.# 3,2,2,1
?###?????? 6,1
???##.#??#?? 1,3,1,3
???##??..?#?#??? 3,4
??????##??.?????#? 9,1,5
?#???#?.?#???? 5,5
??.?.???.?? 1,2
??##??#?????# 2,7
???????.???????##?#. 1,1,1,1,7
#?#????#???.##.? 8,1,2,1
???#.??###??..#?#?? 1,1,4,1,1,3
.?.??###???#?.?????? 7,1
?#?#?#???????.?#? 5,2,3,2
???##???.??????#? 1,3,1,1,5
???????#?#??.? 1,2,5
????#?.??? 2,1,1"""
## 000010-1000
def preprocess(line):
    s = line.split(" ")
    nums = s[1].split(",")
    x = s[0]
    arr = []
    count = 0
    for c in x:
        if c == "?":
            if count > 0:
                arr.append(count)
            count = 0
            arr.append(0)
        elif c == ".":
            if count >0:
                arr.append(count)
                count = 0
            arr.append(-1)
        else:
            count+=1
    if count>0:
        arr.append(count)
    return arr, [int(n) for n in nums]

memo = {}
def check_remaining_not_positive(arr):
    for ele in arr:
        if ele > 0:
            return False
    return True

def solve(arr, nums):
    # my first attempt which was half recursive half iterative which was just shit 
    # but in writing this, I was able to gain insight on what I needed for a pure recursive function
    # so while writing solve() took like 1.5 hours, solves() took like 30 minutes and 10 for debugging
    # will leave this here as a testament to how shit rough drafts are
    curr_i = 0
    curr_ele = arr[curr_i]
    if str(arr)+str(nums) in memo:
        return memo[str(arr)+str(nums)]
    temp_arr, temp_nums = arr, nums
    end = len(arr)
    count = 1
    while curr_i < end and temp_nums[0]>0:
        curr_ele = arr[curr_i]
        if curr_ele == -1:
            curr_i+=1
        elif curr_ele > 0:
            if curr_ele > temp_nums[0]:
                #think this should be impossible though
                print("wtf", arr,temp_nums)
                return 0
                curr_i+=2
            elif curr_ele == temp_nums[0]:
                curr_i+=2
                temp_nums = temp_nums[1:]
                count+=1
                if len(nums == 0):
                    memo[str(arr)+str(nums)] = count
                    return count
            else:
                diff = nums[0] - curr_ele
                tce = curr_ele
                can_add = True
                for i in range(diff):
                    if i < end:
                        temp_curr_ele = arr[curr_i+i]
                        if temp_curr_ele == 0:
                            tce+=1
                            continue
                        elif temp_curr_ele == -1:
                            can_add = False
                            break
                        else:
                            if tce+temp_curr_ele <= nums[0]:
                                tce+=temp_curr_ele
                                continue
                            else:
                                can_add = False
                if curr_i+diff+1 < end and arr[curr_i+diff+1] > 0:
                    can_add = False

                if can_add:
                    temp_nums = temp_nums[1:]
                    count+=1
                    if len(temp_nums) == 0:
                        memo[str(arr)+str(nums)] = count
                        return count
                    curr_i = curr_i+diff+2
                    if curr_i < end:
                        count += solve(temp_arr[curr_i:], temp_nums)
                        memo[str(arr)+str(nums)] = count
                        return count
        else:
            next_i = curr_i +1
            if next_i == end:
                # last element
                if nums[0] == 1:
                    count+=1
                memo[str(arr)+str(nums)] = count
                return count

            # do
            if arr[next_i] > 0:
                if arr[next_i] < nums[0]:
                    temp_arr[next_i] = temp_arr[next_i]+1
                    return count+solve(temp_arr[next_i:, nums[1:]])
                elif arr[next_i] == nums:
                    continue
                else:
                    #shouldnt have done somethning earlier
                    return 0 # not sure return 0 or count        

            elif arr[next_i] == -1:
                # this has to be a 1er or else we lose
                if nums[0] == 1:
                    #  nice
                    temp_nums = nums[1:]
                    if len(temp_nums) == 0:
                        # no more nums, check if rest of array is clean of #
                        if check_remaining_not_positive(arr[next_i:]):
                            count+=1
                            return count

                    else:
                        # more to be done, not end of array still nums left
                        count += solve(arr[next_i:], temp_nums)
            else:
                temp_arr[curr_i] = 1
                temp_nums[0] = temp_nums[0]-1
                count+= solve(temp_arr, temp_nums)
            

            print(arr[next_i:], nums)
            count+=solve(arr[next_i:], nums)
            curr_i+=1
    return count


def solves(arr,num):
    ta,tn = arr.copy() ,num.copy() 
    # deep copies creates over head but luckily the arrays are small
    # if these were large I'd have to think of something cleverer
    if arr == []:
        if num == []:
            return 1
        return 0
    if num == []:
        # check if remaining arr is 0s or -1s. 
        if check_remaining_not_positive(arr):
            return 1
        return 0

    if len(arr) == 1:
        if len(num) == 1:
            if num[0] == arr[0] or (arr[0] == 0 and num[0] == 1):
                return 1
            return 0
        return 0
    tokenized = str(arr)+str(num)
    if tokenized in memo:
        return memo[tokenized]
    count = 0
    if arr[0] == -1:
        return solves(ta[1:], num)
    elif arr[0] == 0:
        # question mark, now we skip or modify
        # modify -----
        ta[0] = 1
        count += solves(ta, num)

        # skip ------
        count += solves(ta[1:], num)
        # this was just one line but forgot to add it on my first solve. 
        memo[tokenized] = count
        return count
    else:
        # we have a hashtag to deal with
        # first check if we are in a dead position
        curr = arr[0]
        if curr > num[0]:
            # dead, like 0,0,0,0,0,4,0,0 - 4,1
            return 0
        elif curr == num[0]:
            # ok nothing to do here then
            # we skip cut off current element and the next because next one can't be a # and if its a ? its a . and if its a . then yay
            # make sure next element isn't positive
            if arr[1] > 0:
                return 0
            
            return solves(ta[2:], tn[1:])
        else:
            # now check if we can match
            if ta[1] == -1:
                # nope we lose
                return 0
            # its a zero lets just add 1 and hope for the best.  
            ta[1] = ta[0]+max(ta[1],1)
            return solves(ta[1:], num)
start = time.time()  
ans = 0
lines = input.split("\n")
for line in lines:
    arr, nums = preprocess(line)
    s = solves(arr,nums)
    ans+=s
end = time.time()
print(ans)
print(end-start,"seconds")
    
def part_2(line):
    s = line.split(" ")
    a = s[0]
    n = s[1]
    for i in range(4):
        a+="?"+s[0]
        n+=","+s[1]
    return a+" "+n

start = time.time()  
ans = 0
lines = input.split("\n")
for line in lines:
    part_two_line = part_2(line)
    arr, nums = preprocess(part_two_line)
    s = solves(arr,nums)
    ans+=s
end = time.time()
print(ans)
print(end-start,"seconds")
